<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Optional: set direct HTTPS backend via meta tag (can also use URL ?apiBase=...) -->
    <meta name="polly-api-base" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polly</title>
    <link rel="stylesheet" href="css/styles.css">
    <!-- Import map to resolve bare specifier 'three' used by JSM modules -->
    <script type="importmap">
      {
        "imports": {
          "three": "https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.module.js"
        }
      }
    </script>
    <!-- Three.js Libraries (CSP-safe ES modules) -->
    <script type="module">
      import * as THREE from 'three';
      import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.132.2/examples/jsm/controls/OrbitControls.js';
      import { GLTFLoader } from 'https://cdn.jsdelivr.net/npm/three@0.132.2/examples/jsm/loaders/GLTFLoader.js';
      // Expose to global for existing non-module code
      window.THREE = THREE;
      window.OrbitControls = OrbitControls;
      window.GLTFLoader = GLTFLoader;
    </script>
</head>
  <body>
    <!-- Debug Panel: visible when URL has ?debug=1 -->
    <div id="debug-panel" style="display:none; font-family: ui-monospace, Menlo, Monaco, Consolas, 'Courier New', monospace; font-size:12px; background:#fafafa; border:1px solid #eaeaea; border-radius:8px; padding:12px; margin:12px; white-space:pre-wrap;">
      <div style="font-weight:600; margin-bottom:8px;">Request Debug</div>
      <div id="debug-content">No requests yet.</div>
      <div style="margin-top:8px; color:#666;">Tip: add <code>?debug=1</code> to the URL to keep this panel visible.</div>
    </div>
    <header>
        <nav>
            <a class="logo" href="index.html" aria-label="Polly home">
              <img src="assets/images/logo-modern.svg" alt="Polly logo" onerror="this.onerror=null; this.src='assets/images/logo.png';" />
              <span class="logo-text">Polly</span>
            </a>
            <ul class="nav-links">
                <li><a href="index.html" class="active">Home</a></li>
                <li><a href="gallery.html">Gallery</a></li>
                <li><a href="faq.html">FAQ</a></li>
                <li><a id="login-link" href="#">Login</a></li>
            </ul>
        </nav>
    </header>

    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1>Upload! Transform into 3D!</h1>
                <p>Turn any image or text into premium 3D models instantly.</p>
                <a href="#converter" class="btn btn-primary btn-large cta-breathe">Try It Free</a>
            </div>
        </div>
    </section>

    <section id="converter" class="converter-section">
        <div class="container">
            <h2>Image to 3D Converter</h2>
            <div class="converter-container">
                <div class="upload-area">
                    <h3>Upload Image</h3>
                    <div id="upload-box" class="upload-box">
                        <div id="upload-placeholder" class="upload-placeholder">
                            <img src="assets/images/upload-icon.svg" alt="Upload Icon">
                            <p>Drag & Drop your image here</p>
                            <span>or</span>
                            <input type="file" id="file-input" accept="image/*" hidden>
                            <label for="file-input" class="btn btn-primary">Browse Files</label>
                        </div>
                        <div id="uploaded-image-container" class="uploaded-image-container" style="display: none;">
                            <button id="upload-close" class="upload-close" aria-label="Delete">&times;</button>
                            <img id="uploaded-image" src="" alt="Uploaded Image">
                            <div class="upload-actions">
                                <button id="reset-button" class="btn btn-secondary" style="display: none;">Reset</button>
                                <button id="generate-button" class="btn btn-primary btn-wide" style="display: none;">Generate 3D Model</button>
                            </div>
                        </div>
                    </div>
                    
                </div>
                <div class="preview-area">
                    <h3>3D Model Preview</h3>
                    <div id="preview-container" class="preview-container">
                        <div id="preview-placeholder" class="preview-placeholder">
                            <p>Your 3D model will appear here</p>
                        </div>
                        <!-- Inline processing overlay inside preview container -->
                        <div id="preview-loading" class="preview-loading" style="display:none;">
                            <div class="loading-visual">
                                <div class="loading-orbit">
                                    <div class="loading-cube"></div>
                                    <span class="loading-dot d1"></span>
                                    <span class="loading-dot d2"></span>
                                    <span class="loading-dot d3"></span>
                                </div>
                            </div>
                            <p id="preview-loading-text" class="loading-title">It may take a moment to generate.</p>
                            <div class="loading-ellipsis" aria-hidden="true">
                                <span></span><span></span><span></span>
                            </div>
                            <div class="loading-desc">You can wait here or check it later in My Assets.</div>
                        </div>
                        <div id="model-viewer" style="display: none;"></div>
                    </div>
                    <div id="preview-controls" class="preview-controls">
    <button id="download-button" class="btn btn-primary btn-wide" disabled>Download</button>
</div>
        </div>
      </div>
    </div>
            </div>
        </div>
    </section>

<footer>
    <div class="container">
        <p>&copy; 2023 Polly. All rights reserved.</p>
        <div class="footer-links contact-row">
          <a href="mailto:support@polly3d.com" aria-label="Email support@polly3d.com">support@polly3d.com</a>
          <a href="tel:8888888888" aria-label="Phone 888-888-8888">888-888-8888</a>
        </div>
        <div class="footer-list">
          <a href="privacy.html">Privacy Policy</a>
          <a href="terms.html">Terms of Use</a>
        </div>
    </div>
</footer>

    <div id="notification" class="notification" style="display: none;">
        <span id="notification-message"></span>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner"></div>
        <p id="loading-text">Processing...</p>
    </div>

    <!-- Login Modal (two-step like screenshot) -->
    <div id="login-modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:1000; align-items:center; justify-content:center;">
      <div style="background:#141820; color:#fff; border-radius:16px; padding:24px; width:420px; box-shadow:0 12px 32px rgba(0,0,0,0.35);">
        <div style="display:flex; align-items:center; justify-content:space-between;">
          <div style="display:flex; align-items:center; gap:8px;">
            <span style="font-weight:700; font-size:20px;">Polly</span><span style="width:10px; height:10px; background:#FFC65A; border-radius:50%; display:inline-block"></span>
          </div>
          <button id="login-close" aria-label="Close" style="border:none; background:transparent; font-size:22px; line-height:1; cursor:pointer; color:#fff">×</button>
        </div>

        <!-- Step 1: method selection -->
        <div id="login-step-select" style="margin-top:20px; display:block;">
          <button id="select-email-or-phone" style="width:100%; padding:14px 16px; border:none; border-radius:999px; background:#fff; color:#111; font-size:16px; display:flex; align-items:center; justify-content:center; gap:10px; margin-bottom:14px;">
            <span>✉️</span>
            <span>Sign in with Email / Phone</span>
          </button>
          <button id="select-apple" style="width:100%; padding:14px 16px; border:none; border-radius:999px; background:#fff; color:#111; font-size:16px; display:flex; align-items:center; justify-content:center; gap:10px; margin-bottom:14px;">
            <span></span>
            <span>Continue with Apple</span>
          </button>
          <button id="select-google" style="width:100%; padding:14px 16px; border:none; border-radius:999px; background:#fff; color:#111; font-size:16px; display:flex; align-items:center; justify-content:center; gap:10px;">
            <span style="color:#4285F4">G</span>
            <span>Continue with Google</span>
          </button>
          <div style="margin-top:16px; font-size:12px; text-align:center; color:#B8C0CC;">
            I agree to Polly's <a href="faq.html" style="color:#B8C0CC; text-decoration:underline;">Community Guidelines</a> and <a href="terms.html" style="color:#B8C0CC; text-decoration:underline;">Terms of Service</a> and <a href="privacy.html" style="color:#B8C0CC; text-decoration:underline;">Privacy Policy</a>
          </div>
        </div>

        <!-- Step 2: forms -->
        <div id="login-step-forms" style="margin-top:20px; display:none;">
          <div style="display:flex; align-items:center; gap:8px; margin-bottom:10px;">
            <button id="login-back" style="border:none; background:transparent; color:#fff; cursor:pointer">←</button>
            <div style="flex:1"></div>
          </div>
          <div style="display:flex; gap:8px; margin-bottom:10px;">
            <button id="tab-sms-otp" class="btn btn-secondary" style="flex:1">Phone</button>
            <button id="tab-email-otp" class="btn btn-secondary" style="flex:1">Email</button>
          </div>
          <!-- SMS OTP Login -->
          <div id="login-form-sms-otp" style="display:flex; flex-direction:column; gap:10px;">
            <div style="display:flex; gap:8px;">
              <select id="sms-country" style="flex:0 0 120px; padding:8px 10px; border:1px solid #344055; background:#1b2230; color:#fff; border-radius:999px;">
                <option value="+886">TW +886</option>
                <option value="+86">CN +86</option>
                <option value="+852">HK +852</option>
                <option value="+81">JP +81</option>
                <option value="+1">US +1</option>
              </select>
              <input id="sms-otp-phone" type="tel" placeholder="Phone number" style="flex:1; padding:8px 16px; border:1px solid #344055; background:#1b2230; color:#fff; border-radius:999px;" />
            </div>
            <div style="display:flex; gap:8px;">
              <input id="sms-otp-code" type="text" placeholder="Verification code" style="flex:1; padding:8px 16px; border:1px solid #344055; background:#1b2230; color:#fff; border-radius:999px;" />
              <button id="sms-otp-send" class="btn btn-secondary" style="flex:0 0 120px; border-radius:999px;">Send</button>
            </div>
            <button id="sms-otp-login" class="btn btn-primary" style="width:100%; border-radius:999px;" disabled>Continue</button>
          </div>
          <!-- Email OTP Login -->
          <div id="login-form-email-otp" style="display:none; flex-direction:column; gap:10px;">
            <input id="email-otp-email" type="email" placeholder="Email" style="width:100%; padding:8px 16px; border:1px solid #344055; background:#1b2230; color:#fff; border-radius:999px;" />
            <div style="display:flex; gap:8px;">
              <input id="email-otp-code" type="text" placeholder="Verification code" style="flex:1; padding:8px 16px; border:1px solid #344055; background:#1b2230; color:#fff; border-radius:999px;" />
              <button id="email-otp-send" class="btn btn-secondary" style="flex:0 0 120px; border-radius:999px;">Send</button>
            </div>
            <button id="email-otp-login" class="btn btn-primary" style="width:100%; border-radius:999px;" disabled>Continue</button>
          </div>
          <div style="margin-top:12px; font-size:12px; text-align:center; color:#B8C0CC;">
            I agree to Polly's <a href="faq.html" style="color:#B8C0CC; text-decoration:underline;">Community Guidelines</a> and <a href="terms.html" style="color:#B8C0CC; text-decoration:underline;">Terms of Service</a> and <a href="privacy.html" style="color:#B8C0CC; text-decoration:underline;">Privacy Policy</a>
          </div>
        </div>

        <div id="login-error" style="display:none; margin-top:10px; color:#ff6b6b; font-size:12px;">Sign in failed, please try again.</div>
      </div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/main.js"></script>
</body>
</html>